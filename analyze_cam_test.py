# -*- coding: utf-8 -*-
"""
Created on Fri Jan  4 21:16:09 2013
Description: Testing on 1K93 (cam_test is a folder on the desktop)
@author: root
"""
from myPDB import *
MI1=[np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.05312792254200751,0.06293176171118854,0.09473013274550822,0.09473013274550822,0.09473013274550822,0.09473013274550822,0.09473013274550822,0.09473013274550822,0.09473013274550822,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09499179142993251,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.09277806267752851,0.0596703193526879,0.0596703193526879,0.0596703193526879,0.0596703193526879,0.05351541233120668,0.05351541233120668,0.03577546906313384,0.02923574837574828,0.02923574837574828,0.02923574837574828,0.02923574837574828,0.01674439715475761,0.00762633082115188,0.005106776664076704,0.005106776664076704,0.016839384939399734,0.016839384939399734,0.016839384939399734,0.016839384939399734,0.016839384939399734,0.016839384939399734,0.033665062203899684,0.033665062203899684,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,0.043970004120270134,-0.002920525869585959,-0.01398926420873877,-0.01398926420873877,-0.0064995682069015626,-0.0064995682069015626,-0.0064995682069015626,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.014127576939670046,0.02502000670726763,0.02502000670726763,0.02502000670726763,0.02502000670726763,0.02502000670726763,0.02502000670726763,0.02502000670726763,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.03207600554449573,0.02365004118500984,0.02365004118500984,0.02365004118500984,0.02365004118500984,0.02365004118500984,0.02365004118500984,0.02365004118500984,0.020440810368085503,0.020440810368085503,0.020440810368085503,0.020440810368085503,0.020440810368085503,0.020440810368085503,0.020440810368085503,-0.02231750126692223,-0.021179792138975723,0.018877890079245695,0.018877890079245695,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.1115796400026509,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.07541340018702528,0.04477564643657717,0.04477564643657717,0.04477564643657717,0.04477564643657717,0.04477564643657717,0.003522941753070899,0.003522941753070899,0.003522941753070899,0.003522941753070899,0.003522941753070899,0.003522941753070899,0.032196409103344016,0.032196409103344016,0.032196409103344016,0.032196409103344016,0.032196409103344016,0.032196409103344016,0.03262314472084725,0.03262314472084725,0.03262314472084725,0.03262314472084725,0.03262314472084725,0.03262314472084725,0.03262314472084725,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.04383410707830277,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.06445371324649435,0.07545485694163671,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.12157165468936941,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.06035312262327541,0.010002312550243225,0.010002312550243225,0.010002312550243225,0.0069055688648784475,0.0069055688648784475,0.0069055688648784475,-0.03589458616624179,-0.03589458616624179,-0.03589458616624179,-0.03589458616624179,-0.03589458616624179,-0.01852391703404689,-0.01852391703404689,-0.01852391703404689,-0.01852391703404689,-0.01852391703404689,-0.01852391703404689,-0.006783303133620066,-0.006783303133620066,-0.006783303133620066,0.00757192705612074,0.04420491485170159,0.04420491485170159,0.04420491485170159,0.04420491485170159,0.04420491485170159,0.04420491485170159,0.04420491485170159,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.06971103183279584,0.03030459753533004,0.03030459753533004,0.03030459753533004,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.02900669656947468,0.021956624939640908,0.04523368086892076,0.04523368086892076,0.05941516794975423,0.07984039993939536,0.07984039993939536,0.07984039993939536,0.07984039993939536,0.07984039993939536,0.07984039993939536,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.13120020195377813,0.06668132497210869,0.06430474341018177,0.06430474341018177,0.06430474341018177,0.06430474341018177,0.06430474341018177,0.05157176117437238,0.05157176117437238,0.05157176117437238,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.05252223330415666,0.0612018890146183,0.0612018890146183,0.0612018890146183,0.07756666612733878,0.07756666612733878,0.10447310519250845,0.10447310519250845,0.12303210131315614,0.12303210131315614,0.12303210131315614,0.12303210131315614,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.12745709879074812,0.10812476330572082,0.10812476330572082,0.10812476330572082,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0660717795393144,0.0676555141562386,0.0676555141562386,0.0676555141562386,0.0676555141562386,0.0676555141562386,0.0676555141562386,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.07596315140740792,0.05050946537980405,0.05050946537980405,0.04541178819421282,0.04541178819421282,0.04541178819421282,0.04541178819421282,0.031753398699190756,0.027061591528895104,0.027061591528895104,0.027061591528895104,0.02495168885979384,0.02495168885979384,0.02495168885979384,-0.017660715104855042,-0.017660715104855042,-0.03427130950456281,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan];
MI1=[np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,-0.017342299984104154,0.02605799277707536,-0.08919867383942778,-0.054925444795228984,-0.032098074221136794,-0.03424131703611206,0.05312792254200751,-0.030338351227121946,-0.010687382126134057,0.012580368424614602,0.04161577619490405,0.05258077407952134,-0.027722296397260218,0.006112631048082694,-0.02782767205012542,-0.07879335075600297,-0.020054156628555656,-0.054149059578285454,0.022252307298706434,0.06293176171118854,0.09473013274550822,0.0563064845161543,0.04827588938753305,0.08391712364668791,0.09250984399942178,0.054455597366857116,0.00246482936635066,0.09499179142993251,-0.00751392594789799,0.02479033512576274,0.0184150197968707,0.015772867361643912,0.020823488696042995,0.06003089243023797,0.0005336961769257763,0.05074420837831517,0.054569345399141864,0.09277806267752851,0.04008273083086155,0.024983704132480338,0.05482881340470665,0.0596703193526879,0.012433403668823603,0.05351541233120668,0.03577546906313384,-0.009911855902778245,0.022410256342316113,0.004566217429098516,0.02923574837574828,0.01674439715475761,0.00762633082115188,-0.034303709543702765,-0.01967590510461379,-0.009485894309436443,-0.09396913271957844,-0.07918882618002714,-0.0479914904649035,-0.06733521300756767,-0.09716729603026263,-0.031054793935889967,-0.08464527712456489,-0.05350771410824733,-0.04257573758422098,-0.08731644652444596,-0.10694658471078823,-0.0643703330916654,0.005106776664076704,-0.029633464114686023,-0.0687503616589221,-0.032260032051177515,-0.04615013488235951,-0.04892168947573984,-0.06370174881734131,0.016839384939399734,-0.0023427561063918065,-0.04851954785996827,0.01469124368100044,-0.012423357453686364,0.0018919735400254982,0.033665062203899684,-0.015408506315331173,0.043970004120270134,-0.002920525869585959,-0.02831800400327559,-0.01398926420873877,-0.04572903305191038,-0.08798455664374669,-0.11580357027799312,-0.0657552972619455,-0.062154349732523276,-0.08135523851010432,-0.05706710217370529,-0.08072160419085467,-0.1028839911900442,-0.05230048381862375,-0.03571868772316722,-0.0637423559682975,-0.052113115208740374,-0.06682007248584093,-0.07236758744490365,-0.06100841959727554,-0.13897391288859884,-0.046749141838542695,-0.07160217097277123,-0.11274519252335043,-0.0064995682069015626,-0.029874978075902635,-0.07100801883961298,0.014127576939670046,-0.03391681453215446,-0.08497789426047878,-0.09330705862026356,-0.00948069347634414,-0.02392731062332473,-0.06770175185843352,-0.03182385117004311,0.02502000670726763,-0.015913708013981873,0.009455941412687244,-0.06003080948548366,-0.054689384766410415,-0.07536666421156193,-0.004320882155076779,0.03207600554449573,0.002049300418148499,-0.04365123798061225,-0.012254390570663763,0.002779218150593569,-0.030653675453386542,-0.01493966830509622,0.02365004118500984,0.005679701685311421,-0.047546476895122355,-0.03197909732850192,-0.05765967870024413,-0.016439776299749104,-0.028959291836073334,0.020440810368085503,-0.03766187755255574,-0.04996045380203135,-0.07130997830761665,-0.10985889988803839,-0.08419640110216789,-0.02231750126692223,-0.1163469808740771,-0.024585453603527062,-0.07441802390677582,-0.06976426987252607,-0.08646657913280159,-0.05341130703982812,-0.05883044532877425,-0.0735606200322676,-0.040695115172153164,-0.023519363259924396,-0.05679502564973084,-0.06748496663800127,-0.06774507526502728,-0.08718613814755331,-0.057649970543056483,-0.021179792138975723,0.018877890079245695,-0.0041959896303116195,0.1115796400026509,0.017657410673509587,0.027823743323540984,0.04001871542376205,0.0423218917257519,-0.0192475865830425,0.026424473433602873,0.03145988331232362,0.02942758020269709,0.00919969370682296,0.026399207579557,-0.0024563583752514884,0.07541340018702528,-0.01999252315432091,-0.0017098793511900546,0.03959307222389719,-0.004605222714998348,0.04477564643657717,-0.032403458745138815,0.002834755836915965,-0.05229470284590745,-0.07689553970298574,-0.10313286107704386,-0.018403726121270406,-0.06004962525150477,-0.036982656034538056,-0.07402082010364851,-0.08953411113760579,-0.06455304715292919,-0.10632514562364917,-0.12197454816106529,-0.1272471587890223,-0.04638092027217557,-0.08654127945234819,-0.06793258434267496,-0.016221325884865787,-0.07045214925687943,-0.03536024572349393,0.003522941753070899,-0.0597615290944039,-0.02288581194823403,-0.03632077116846489,-0.03894783024353606,0.0016908540556035533,0.032196409103344016,-0.03962280444167907,-0.020054296195697225,-0.023222841807319174,-0.042955815285231194,-0.05598265647659761,0.03262314472084725,-0.011135337660598679,-0.023857828105198264,0.028666648498176496,-0.024064856197568534,-0.009298742437937506,0.009680908837317904,0.04383410707830277,-0.029859044494050257,0.0025029722134974827,0.010243617477584673,-0.021836659968170545,-0.045487369992538884,-0.040746919675808735,-0.03493028500367125,-0.017350624544118846,-0.05923183503793687,-0.007420251845559608,0.06445371324649435,0.029845929975207505,0.033332188778168584,0.010551595335479638,-0.046949187502417625,0.029735198981690948,0.0011266716827741333,-0.07587916977311304,0.030481850066493198,-0.07690489517493002,-0.057749413031606175,0.005381666168649447,0.025160523965171235,0.019337585689696322,0.012031360372483256,0.032689617452133134,0.01657605193814081,0.023699685784805906,0.07545485694163671,0.12157165468936941,0.03700159716337509,-0.030796319467421764,0.053793164209106174,0.04779232036684715,0.02981033277380384,0.02755743848753099,0.04532894283534493,-0.0033458448131559668,-0.011911061970093544,0.053685916718873655,0.06035312262327541,-0.06089677697212891,-0.00581256282881544,0.010002312550243225,-0.09503081732357137,-0.07914349795071712,0.0069055688648784475,-0.09274828689297451,-0.04690595287436214,-0.048431758032903574,-0.1054487240816343,-0.0979606149751587,-0.03589458616624179,-0.056325257309579546,-0.0964001368471564,-0.10215140030319247,-0.0728890029311526,-0.16093789334912206,-0.0926603306734996,-0.09859623972585009,-0.09792807389503988,-0.14158794955925455,-0.09579179636098777,-0.13701999673262155,-0.07537487206546366,-0.12906676723342766,-0.0709588228550212,-0.07620677211746744,-0.06350392009211973,-0.08543771620973352,-0.06931351568043387,-0.10645398634138552,-0.01852391703404689,-0.06931629504953545,-0.09098834436444475,-0.08820453436039402,-0.022169465232394957,-0.062176428026714,-0.006783303133620066,-0.008604448408403164,-0.021718848905294644,0.00757192705612074,0.04420491485170159,0.0013260779359970127,-0.04029034028023571,-0.031459503602591546,-0.029303036706368482,-0.11148675688972011,-0.008671860811786482,0.06971103183279584,-0.007444077151213178,0.013018185933938952,0.03030459753533004,-0.0693087011930818,-0.009496596270925214,-0.012340778742985075,-0.060286402352589565,0.01239496895975422,-0.0036358271857498993,-0.01569026321647638,-0.013805233370581652,-0.042606439554080874,-0.04726033044953509,-0.018806599725286272,0.0024478893602206953,-0.02978864060433349,0.02900669656947468,-0.06531614254270351,-0.030689044914341046,-0.011712456108544628,-0.04502221479088313,-0.025192750869772847,-0.06551791039785446,-0.02931047556917271,-0.02933041771541079,-0.011041801904068164,-0.009134087408865895,-0.015170339626718796,-0.044006879993624945,-0.05308019842533787,-0.06415501052219935,-0.08174173477182803,-0.059674769025901235,-0.02702053565132899,-0.015579605454140444,-0.007485400501138703,-0.037202007529591435,0.021956624939640908,0.04523368086892076,0.011800919221587134,0.05941516794975423,0.07984039993939536,-0.006628835371735482,0.06213735079287398,0.03507437252368004,0.011326027804406162,0.0174932668260632,0.13120020195377813,0.06668132497210869,0.03386883712355425,0.036404726181808136,0.039988329550000735,0.020492546811447587,0.06430474341018177,0.001978779317054997,-0.046292946516908046,-0.007665598202381906,0.05157176117437238,0.03522922054363658,-0.013475479029006608,-0.04004184106901568,-0.0737788986807604,-0.0328410266982596,-0.028249476107370917,-0.04118228622528007,-0.05762249744842802,-0.04765957093930023,-0.04320684120452387,-0.019643165540488026,0.004115525192682254,-0.0221439492379217,-0.024708107057546672,0.00027730804888729393,0.012608019847520392,-0.03470430399615228,-0.03438073163576539,0.0352996195949681,0.05252223330415666,0.011048542693485972,-0.0646424408421172,-0.017465303598678022,-0.003529818000185575,0.02284504802103497,-0.012865129553571965,-0.034971782221406206,-0.06978570722621755,0.010534015918786475,0.03930680887355882,0.000578714013887446,0.007016323166586579,0.0612018890146183,0.007974878769441685,0.0353525338154366,0.07756666612733878,0.06252578240598779,0.10447310519250845,0.09307892883008512,0.12303210131315614,0.07626103891368906,0.07140729615795571,0.019593053662110213,0.12745709879074812,0.02233188729862176,0.09423532734569268,0.10812476330572082,0.03843134801278038,0.06500605613028308,0.04417041392454039,-0.012188837534478386,-0.02022250180572297,0.05642325157300827,-0.013815015725680354,0.004870723682801656,-0.05503368322332131,-0.034022757656037364,-0.027591489137970174,-0.034627841161103914,-0.08077752873237873,-0.006802897919150796,-0.060501694246858556,0.02723904455378799,-0.04117601757488289,-0.06327904657050235,-0.026764396597550404,0.0660717795393144,-0.0033015299205856087,0.031614972943451725,0.04234188283225215,-0.02975883403133071,0.009567511468438015,0.04751356219814121,-0.00534207959795506,-0.014363744162440267,0.035759637037961645,0.05373472945158588,0.0676555141562386,0.0322163407970571,0.05447361735554153,0.02576829921123566,0.02089302166015155,0.007461477711096454,0.07596315140740792,0.024817807314034372,0.05050946537980405,0.038669612268380116,0.031616629916836864,-0.0036722697371363647,0.04541178819421282,0.031753398699190756,-0.02134712251560173,-0.03008387874147509,0.027061591528895104,0.007726526562079948,-0.005745383159325523,0.02495168885979384,-0.03118477941530029,-0.017660715104855042,-0.056075972831973186,-0.04732579512093465,-0.0843366731881427,-0.06619002491211914,-0.0666161384173127,-0.041947917583053315,-0.03427130950456281,-0.09823868470526455,-0.0899466711671793,-0.07572542929442391,-0.12331699281489071,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan,np.nan]
from PyML.evaluators import roc
def merge_shandar():
    #if the file is broken as 1-260,251-498 then the following code can be used
    #to merge the two files from shandar
    ofile=open('/media/sf_Desktop/Cam_test/Shandar_prediction/pw_2_.txt','w')
    for ln in open('/media/sf_Desktop/Cam_test/Shandar_prediction/pw_2.txt','r'):
        lns=ln.split(':')
        rn=int(lns[1][1:])
        if rn>=6:
            lns[1]=lns[1][0]+str(rn+250)
            ofile.write(':'.join(lns))
    ofile.close()

def plotdv(rseqn,dv):
    dv2=(dv-np.nanmin(dv))/(np.nanmax(dv)-np.nanmin(dv))
    plt.plot(rseqn,dv2)
    
if __name__=="__main__":
    cdir='/media/sf_Desktop/Cam_test/' #/media/sf_Desktop/Cam_test/Shandar_prediction
    pdbdir=cdir+'CAM_PDB/'
    cid='X000'
    L=myPDB.loader(pdbdir+cid+'_l_u.pdb.pkl')
    R=myPDB.loader(pdbdir+cid+'_r_u.pdb.pkl')
    rseqn=[int(dict(zip(R.resi.values(),R.resi.keys()))[k][1]) for k in R.S2Ri] #true sequence
    trbs=[2*((v>=500 and v<540) or (v>=614 and v<634) or (v>=646 and v<672) or (v>694 and v<721))-1 for v in rseqn]
    lseqn=[int(dict(zip(L.resi.values(),L.resi.keys()))[k][1]) for k in L.S2Ri]
    #Get shandar's matrix
    M=np.zeros((len(L.S2Ri),len(R.S2Ri)))
    M.fill(np.nan)
    ifile=cdir+'/Shandar_prediction/shandar_X000.txt'
    for ln in open(ifile,'r'):
        lns=ln.split(':')
        r=int(lns[0][1:])-1 #Shandar starts at 1
        c=int(lns[1][1:])-1
        v=float(lns[2])
        M[r,c]=v
    #Get true
    Mt=np.zeros((len(L.S2Ri),len(R.S2Ri)))
    #M.fill(np.nan)
    rseqnd=dict(zip(rseqn,range(len(rseqn))))
    lseqnd=dict(zip(lseqn,range(len(lseqn))))
    ifile=cdir+'/psaia_contacts/chain_A_D.txt'
    for ln in open(ifile,'r'):
        lns=ln.split()
        try:
            r=lseqnd[int(lns[4])]
            c=rseqnd[int(lns[1])]
            Mt[r,c]=1.0
        except:
            continue
    #Get our results
    Mo=np.zeros((len(L.S2Ri),len(R.S2Ri)))
    Mo.fill(np.nan)
    ifile=cdir+'/InterPRed_prediction/2X000.InterPRed.txt'

    for ln in open(ifile,'r'):
        lns=ln.split()
        r=int(lns[3])
        c=int(lns[8])
        v=float(lns[10])
        Mo[r,c]=v    
    """
    print 'MI1- auc',roc.roc(MI1,trbs)[-1]
    print 'Shandar - auc',roc.roc(np.nanmax(M,axis=0),trbs)[-1]
    print 'Our - auc',roc.roc(np.nanmax(Mo,axis=0),trbs)[-1]
    plotdv(rseqn,trbs)
    plotdv(rseqn,np.nanmax(M,axis=0))
    plotdv(rseqn,np.nanmax(Mo,axis=0))
    #plotdv(rseqn,MI1)
    plt.show()
    """
    plt.plot([0,1],[0, 1],'k:',linewidth=2.0)
    (fp,tp,auc)=roc.roc(list(M.flatten()),list(Mt.flatten()));plt.plot(fp,tp,'r-.',linewidth=2.0);print auc
    (fp,tp,auc)=roc.roc(MI1,list(np.nanmax(Mt,axis=0)));plt.plot(fp,tp,'g--',linewidth=2.0);print auc
    (fp,tp,auc)=roc.roc(list(Mo.flatten()),list(Mt.flatten()));plt.plot(fp,tp,'b-',linewidth=2.0);print auc
    plt.grid()
    plt.xlabel('FPR')
    plt.ylabel('TPR')
    plt.legend(['Random : 50.0','PPiPP : 54.0','MI-1 : 59.6','PAIRPred : 63.8'],loc=0);plt.title('EF-CAM Results');plt.show()